---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";
import BaseLayout from "../layouts/BaseLayout.astro";
import SectionHeader from "../components/SectionHeader.astro";
import photoBorovets from "../assets/images/foog-borovets.jpg";
import photoBorovetsHiking from "../assets/images/foog-borovets-hiking-2025.jpg";
import photoBorovetsHikingTwo from "../assets/images/foog-borovets-hiking-2025-2.jpg";
import photoAthamania from "../assets/images/foog-athamania.jpg";
import photoAthamaniaRidge from "../assets/images/foog-athamania.jpeg";
import photoAetomilitsa from "../assets/images/foog-aetomilitsa.jpg";
import photoAetomilitsaGrammos from "../assets/images/foog-aetomilitsa-grammos-1.jpeg";
import photoGrammos from "../assets/images/foog-grammos.jpeg";
import photoPaiko from "../assets/images/foog-katharismos-paiko.jpg";
import photoSkiJunior from "../assets/images/foog-ski-junior.jpg";
import photoVoras from "../assets/images/foog-voras-profitis-hlias.jpg";
import grammosVideo from "../assets/videos/foog-grammos-video.mp4";
import { instagramPosts } from "../data/instagram";

interface InstagramEmbedResult {
  url: string;
  label?: string;
  html: string | null;
  error?: string;
}

interface GalleryItem {
  title: string;
  subtitle: string;
  image?: ImageMetadata;
  video?: string;
  poster?: string;
  alt?: string;
}

const gallery: GalleryItem[] = [
  {
    title: "Προπόνηση σκι στο Μπόροβιτς",
    subtitle: "Χιονοδρομία · 2024",
    image: photoBorovets,
    alt: "Μέλη του Φ.Ο.Ο.Γ. σε χιονοδρομική πλαγιά στο Μπόροβιτς",
  },
  {
    title: "Ορειβατικό μονοπάτι στο Μπόροβιτς",
    subtitle: "Χιονοδρομία & πεζοπορία · 2025",
    image: photoBorovetsHiking,
    alt: "Ομάδα του Φ.Ο.Ο.Γ. σε μονοπάτι στο Μπόροβιτς",
  },
  {
    title: "Άσκηση αντοχής στο Τριεθνές",
    subtitle: "Πεζοπορία · 2025",
    image: photoBorovetsHikingTwo,
    alt: "Μέλη βαδίζουν σε χιονισμένη ράχη κοντά στο Μπόροβιτς",
  },
  {
    title: "Αναβάσεις στην Αθαμανία",
    subtitle: "Ορειβασία · 2023",
    image: photoAthamania,
    alt: "Ομάδα του Φ.Ο.Ο.Γ. στην κορυφογραμμή της Αθαμανίας",
  },
  {
    title: "Ράχη Αθαμανίας στο πρώτο φως",
    subtitle: "Ορειβασία · 2024",
    image: photoAthamaniaRidge,
    alt: "Κορυφογραμμή της Αθαμανίας με μέλη του Φ.Ο.Ο.Γ.",
  },
  {
    title: "Αετομηλίτσα στο λυκόφως",
    subtitle: "Πεζοπορία · 2024",
    image: photoAetomilitsa,
    alt: "Φ.Ο.Ο.Γ. μελών σε ορεινή στάση στην Αετομηλίτσα",
  },
  {
    title: "Σύνδεση Αετομηλίτσας - Γράμμου",
    subtitle: "Διήμερο · 2024",
    image: photoAetomilitsaGrammos,
    alt: "Σημαία του Φ.Ο.Ο.Γ. στον Γράμμο με πανοραμική θέα",
  },
  {
    title: "Κορυφές Γράμμου με χιόνι",
    subtitle: "Ορειβασία · 2024",
    image: photoGrammos,
    alt: "Αθλητές του Φ.Ο.Ο.Γ. σε ανάβαση στον Γράμμο",
  },
  {
    title: "Δρακόλιμνη Γκιστόβα",
    subtitle: "Video highlight · 2024",
    video: grammosVideo,
    alt: "Βίντεο με μέλη του Φ.Ο.Ο.Γ. στον Γράμμο",
  },
  {
    title: "Καθαρισμός μονοπατιού στο Πάικο",
    subtitle: "Περιβαλλοντική δράση · 2024",
    image: photoPaiko,
    alt: "Εθελοντές του Φ.Ο.Ο.Γ. καθαρίζουν μονοπάτι στο Πάικο",
  },
  {
    title: "Παιδικό τμήμα σκι",
    subtitle: "Εκμάθηση · 2024",
    image: photoSkiJunior,
    alt: "Παιδιά με στολές σκι κατά την εκμάθηση",
  },
  {
    title: "Χιονισμένος Προφήτης Ηλίας στον Βόρα",
    subtitle: "Πορεία κορυφής · 2023",
    image: photoVoras,
    alt: "Μέλη του Φ.Ο.Ο.Γ. δίπλα στη σημαία στον Προφήτη Ηλία Βόρα",
  },
];

const photoGallery = gallery.filter(
  (item): item is GalleryItem & { image: ImageMetadata } => Boolean(item.image) && !item.video,
);
const videoGallery = gallery.filter((item) => item.video);
---

<BaseLayout
  title="Γκαλερί"
  description="Εικόνες από πρόσφατες ορειβατικές, σκι και mentoring δράσεις."
>
  <section class="section-padding" data-reveal>
    <SectionHeader
      eyebrow="Οπτικό"
      title="Γκαλερί"
      subtitle="Πέρασε τον δείκτη για λεζάντες και έμπνευση νέων γραμμών"
    />
    <div class="space-y-10">
      <div>
        <h3
          class="mb-4 text-sm font-semibold uppercase tracking-wide text-brand-river"
        >
          Φωτογραφίες
        </h3>
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
          {
            photoGallery.map((item) => (
              <figure
                class="group relative h-64 overflow-hidden rounded-2xl"
                data-reveal
              >
                <Image
                  src={item.image}
                  alt={item.alt ?? item.title}
                  class="h-full w-full object-cover transition duration-500 group-hover:scale-105"
                  loading="lazy"
                />
                <figcaption class="pointer-events-none absolute inset-0 bg-gradient-to-t from-black/80 via-black/10 to-transparent opacity-0 group-hover:opacity-100 transition flex flex-col justify-end p-4">
                  <p class="text-white font-semibold">{item.title}</p>
                  <p class="text-sm text-brand-river">{item.subtitle}</p>
                </figcaption>
              </figure>
            ))
          }
        </div>
      </div>

      {
        videoGallery.length > 0 && (
          <div>
            <h3 class="mb-4 text-sm font-semibold uppercase tracking-wide text-brand-river">
              Βίντεο Highlights
            </h3>
            <div class="max-w-5xl">
              <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
                {videoGallery.map((item) => (
                  <figure
                    class="flex w-full max-w-[18rem] flex-col gap-3 text-left"
                    data-reveal
                  >
                    <div class="aspect-[9/16] w-full overflow-hidden rounded-2xl bg-black">
                      <video
                        class="h-full w-full object-cover"
                        preload="metadata"
                        muted
                        loop
                        playsinline
                        controls
                        poster={item.poster}
                        aria-label={item.alt ?? item.title}
                      >
                        <source src={item.video} type="video/mp4" />Ο περιηγητής
                        σας δεν υποστηρίζει βίντεο HTML5.
                      </video>
                    </div>
                    <figcaption>
                      <p class="font-semibold text-slate-900">{item.title}</p>
                      <p class="text-sm text-brand-river">{item.subtitle}</p>
                    </figcaption>
                  </figure>
                ))}
              </div>
            </div>
          </div>
        )
      }
    </div>
    <p class="mt-8 text-center text-brand-mist text-sm">
      Οι φωτογραφίες προέρχονται από τις πρόσφατες δράσεις του Φ.Ο.Ο.Γ.
    </p>
  </section>
</BaseLayout>
